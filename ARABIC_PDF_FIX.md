# Arabic Text Rendering Fix for PDFs

## Problem
Arabic text appears disconnected (متقطع) in PDFs generated by dompdf because dompdf doesn't support Arabic text shaping (connecting letters).

## Recommended Solution: Use GPDF Package

The best solution is to use the `omaralalwi/gpdf` package, which is specifically designed for Arabic/RTL text in PDFs.

### Installation

```bash
cd backend
composer require omaralalwi/gpdf
```

### Usage

Replace dompdf with gpdf in your controllers:

```php
use Omaralalwi\Gpdf\Gpdf;

// Instead of:
// use Dompdf\Dompdf;
// use Dompdf\Options;

// Use:
$gpdf = new Gpdf();
$gpdf->loadHtml($html);
$gpdf->setPaper('A4', 'portrait');
$gpdf->render();
$pdfContent = $gpdf->output();
```

### Benefits
- Native Arabic/RTL support
- Proper text shaping (connected letters)
- 17 built-in Arabic fonts
- Drop-in replacement for dompdf

## Alternative: Current Workaround

The current implementation includes:
1. Unicode normalization
2. Proper UTF-8 encoding
3. RTL direction in CSS
4. DejaVu Sans font (supports Arabic characters)

However, this still has limitations with text shaping.

## Next Steps

1. **For immediate fix**: Install `omaralalwi/gpdf` package
2. **Update controllers**: Replace Dompdf with Gpdf in:
   - `SaleController.php` (invoice method)
   - `DriverController.php` (settlement method)
3. **Test**: Generate a new PDF and verify Arabic text is properly connected

## Note

The current fixes improve encoding and direction, but dompdf's fundamental limitation with Arabic text shaping means disconnected letters will persist without using a specialized library like GPDF.
